name: Wake Up Render App

on:
  schedule:
    - cron: "55 14 * * *"
  workflow_dispatch:

jobs:
  wake_up:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ• Start workflow
        run: echo "ğŸš€ Workflow started at $(date -u '+%Y-%m-%d %H:%M:%S UTC')"

      - name: ğŸ§© Checkout latest code
        uses: actions/checkout@v4

      - name: ğŸŒ Wake up Render app before midnight job
        run: |
          echo "ğŸ”” Sending ping to Render app to keep it awake before midnight..."
          RESPONSE=$(curl -s -o /dev/null -w "%{http_code}" https://my-japan.onrender.com/api/v1/auth/health)
          if [ "$RESPONSE" -eq 200 ]; then
            echo "âœ… Render app responded with 200 OK"
          else
            echo "âš ï¸ Render app did not respond (HTTP $RESPONSE)"
            exit 1
          fi

      - name: ğŸ•“ Finish workflow
        run: echo "ğŸ‰ Workflow completed at $(date -u '+%Y-%m-%d %H:%M:%S UTC')"
